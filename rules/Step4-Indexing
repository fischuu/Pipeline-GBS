# vim: set filetype=sh :

rule IndexGenomeBWA:
    """
    Index the Mock Reference Genome (BWA).
    """
    input:
        "%s/FASTQ/TRIMMED/GSC.MR.Genome.fa" % (config["project-folder"]),
    output:
        "%s/FASTQ/TRIMMED/GSC.MR.Genome.fa.bwt" % (config["project-folder"])
    log:
        "%s/logs/Step4b-IndexGenome.log" % (config["project-folder"])
    benchmark:
        "%s/benchmark/Step4b-IndexGenome.benchmark.tsv" % (config["project-folder"])
    conda:"envs/gbs.yaml"
    #singularity: config["singularity"]["gbs"]
    shell:"""
        bwa index -a bwtsw {input}
  	"""

rule IndexClustersBWA:
    """
    Index the Mock Reference Genome Clusters (BWA).
    """
    input:
        "%s/FASTQ/TRIMMED/GSC.MR.Clusters.fa" % (config["project-folder"]),
    output:
        "%s/FASTQ/TRIMMED/GSC.MR.Clusters.fa.bwt" % (config["project-folder"])
    log:
        "%s/logs/Step4c-IndexClusters.log" % (config["project-folder"])
    benchmark:
        "%s/benchmark/Step4c-IndexClusters.benchmark.tsv" % (config["project-folder"])
    conda:"envs/gbs.yaml"
    #singularity: config["singularity"]["gbs"]
    shell:"""
        bwa index -a bwtsw {input}
  	"""

rule IndexGenomeSamtools:
    """
    Index the Mock Reference Genome (samtools).
    """
    input:
        "%s/FASTQ/TRIMMED/GSC.MR.Genome.fa" % (config["project-folder"]),
    output:
        "%s/FASTQ/TRIMMED/GSC.MR.Genome.fa.fai" % (config["project-folder"])
    log:
        "%s/logs/Step4b-IndexGenomeSam.log" % (config["project-folder"])
    benchmark:
        "%s/benchmark/Step4b-IndexGenomeSam.benchmark.tsv" % (config["project-folder"])
    conda:"envs/samtools.yaml"
    singularity: config["singularity"]["gbs"]
    shell:"""
        samtools faidx {input}
  	"""

rule IndexClustersSamtools:
    """
    Index the Mock Reference Genome Clusters (samtools).
    """
    input:
        "%s/FASTQ/TRIMMED/GSC.MR.Clusters.fa" % (config["project-folder"]),
    output:
        "%s/FASTQ/TRIMMED/GSC.MR.Clusters.fa.fai" % (config["project-folder"])
    log:
        "%s/logs/Step4c-IndexClustersSam.log" % (config["project-folder"])
    benchmark:
        "%s/benchmark/Step4c-IndexClustersSam.benchmark.tsv" % (config["project-folder"])
    conda:"envs/samtools.yaml"
    singularity: config["singularity"]["gbs"]
    shell:"""
        samtools faidx {input}
  	"""
